<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orbito - Lightweight Browser</title>
    <meta name="description" content="A lightweight, mobile-first browser experience">
    
    <style>
        /* CSS Reset & Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Light theme variables */
            --bg-primary: #f8f9fa;
            --bg-secondary: #ffffff;
            --text-primary: #202124;
            --text-secondary: #5f6368;
            --accent: #1a73e8;
            --border: #dadce0;
            --shadow: rgba(60, 64, 67, 0.1);
            --card-bg: #ffffff;
        }

        [data-theme="dark"] {
            /* Dark theme variables */
            --bg-primary: #202124;
            --bg-secondary: #303134;
            --text-primary: #e8eaed;
            --text-secondary: #9aa0a6;
            --accent: #8ab4f8;
            --border: #5f6368;
            --shadow: rgba(0, 0, 0, 0.3);
            --card-bg: #303134;
        }

        /* Base styles */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.5;
            transition: background-color 0.3s, color 0.3s;
        }

        /* App container */
        .app-container {
            max-width: 100%;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Top bar */
        .top-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            background-color: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logo {
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #4285f4, #34a853, #fbbc05, #ea4335);
            border-radius: 50%;
        }

        .app-name {
            font-weight: 600;
            font-size: 18px;
        }

        .top-bar-buttons {
            display: flex;
            gap: 8px;
        }

        .icon-button {
            background: none;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-secondary);
            transition: background-color 0.2s;
        }

        .icon-button:hover, .icon-button:focus {
            background-color: var(--shadow);
        }

        .icon-button svg {
            width: 20px;
            height: 20px;
        }

        /* Main content */
        .main-content {
            flex: 1;
            padding: 20px 16px;
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        /* Search box */
        .search-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
            margin-top: 20px;
        }

        .search-box {
            width: 100%;
            max-width: 600px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 14px 50px 14px 16px;
            border-radius: 24px;
            border: 1px solid var(--border);
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 16px;
            box-shadow: 0 1px 6px var(--shadow);
            transition: box-shadow 0.2s;
        }

        .search-input:focus {
            outline: none;
            box-shadow: 0 1px 10px var(--shadow);
        }

        .search-button {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-secondary);
            transition: background-color 0.2s;
        }

        .search-button:hover, .search-button:focus {
            background-color: var(--shadow);
        }

        /* Cards */
        .card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 16px;
            box-shadow: 0 1px 3px var(--shadow);
            border: 1px solid var(--border);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .card-title {
            font-size: 16px;
            font-weight: 600;
        }

        .card-action {
            background: none;
            border: none;
            color: var(--accent);
            font-size: 14px;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }

        .card-action:hover, .card-action:focus {
            background-color: var(--shadow);
        }

        /* Quick links grid */
        .quick-links-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 16px;
        }

        .quick-link {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            color: var(--text-primary);
            padding: 12px 8px;
            border-radius: 8px;
            transition: background-color 0.2s;
        }

        .quick-link:hover, .quick-link:focus {
            background-color: var(--shadow);
        }

        .quick-link-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: white;
        }

        .quick-link-name {
            font-size: 12px;
            text-align: center;
            word-break: break-word;
        }

        /* Bookmarks and history lists */
        .bookmarks-list, .history-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .bookmark-item, .history-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px;
            border-radius: 8px;
            transition: background-color 0.2s;
        }

        .bookmark-item:hover, .history-item:hover {
            background-color: var(--shadow);
        }

        .item-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: white;
            flex-shrink: 0;
        }

        .item-details {
            flex: 1;
            min-width: 0;
        }

        .item-title {
            font-size: 14px;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .item-url {
            font-size: 12px;
            color: var(--text-secondary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .item-actions {
            display: flex;
            gap: 4px;
        }

        .item-action {
            background: none;
            border: none;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-secondary);
            transition: background-color 0.2s;
        }

        .item-action:hover, .item-action:focus {
            background-color: var(--shadow);
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 16px;
        }

        .modal {
            background-color: var(--bg-secondary);
            border-radius: 12px;
            padding: 24px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 4px 12px var(--shadow);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-secondary);
            transition: background-color 0.2s;
        }

        .modal-close:hover, .modal-close:focus {
            background-color: var(--shadow);
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 500;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid var(--border);
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 14px;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            margin-top: 24px;
        }

        .btn {
            padding: 10px 16px;
            border-radius: 8px;
            border: none;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .btn-primary {
            background-color: var(--accent);
            color: white;
        }

        .btn-primary:hover, .btn-primary:focus {
            opacity: 0.9;
        }

        .btn-secondary {
            background-color: var(--shadow);
            color: var(--text-primary);
        }

        .btn-secondary:hover, .btn-secondary:focus {
            background-color: var(--border);
        }

        /* PSE containers */
        .pse-search-container {
            margin-bottom: 20px;
        }

        .pse-results-container {
            min-height: 400px;
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-state-text {
            font-size: 14px;
        }

        /* Animation */
        @keyframes glow {
            0% { box-shadow: 0 0 5px var(--accent); }
            50% { box-shadow: 0 0 20px var(--accent); }
            100% { box-shadow: 0 0 5px var(--accent); }
        }

        .glow-animation {
            animation: glow 2s ease-in-out;
        }

        /* Responsive adjustments */
        @media (min-width: 768px) {
            .top-bar {
                padding: 12px 24px;
            }
            
            .main-content {
                padding: 24px;
            }
            
            .quick-links-grid {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            }
        }

        /* Accessibility */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Focus styles */
        button:focus-visible, input:focus-visible, a:focus-visible {
            outline: 2px solid var(--accent);
            outline-offset: 2px;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Top bar -->
        <header class="top-bar" role="banner">
            <div class="logo-container">
                <div class="logo" aria-hidden="true"></div>
                <h1 class="app-name">Orbito</h1>
            </div>
            <div class="top-bar-buttons">
                <button class="icon-button theme-toggle" aria-label="Toggle theme">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12,18C8.69,18 6,15.31 6,12C6,8.69 8.69,6 12,6C15.31,6 18,8.69 18,12C18,15.31 15.31,18 12,18M12,4C7.58,4 4,7.58 4,12C4,16.42 7.58,20 12,20C16.42,20 20,16.42 20,12C20,7.58 16.42,4 12,4M12,7.5C11.17,7.5 10.5,8.17 10.5,9C10.5,9.83 11.17,10.5 12,10.5C12.83,10.5 13.5,9.83 13.5,9C13.5,8.17 12.83,7.5 12,7.5Z" />
                    </svg>
                </button>
                <button class="icon-button incognito-toggle" aria-label="Toggle incognito mode">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12C20,14.63 18.83,16.94 17,18.39C16.67,17.78 15.94,17.25 15,16.89C14.5,16.7 14,16.5 13.5,16.3L12,16L10.5,16.3C10,16.5 9.5,16.7 9,16.89C8.06,17.25 7.33,17.78 7,18.39C5.17,16.94 4,14.63 4,12A8,8 0 0,1 12,4M12,8A4,4 0 0,0 8,12A4,4 0 0,0 12,16A4,4 0 0,0 16,12A4,4 0 0,0 12,8Z" />
                    </svg>
                </button>
                <button class="icon-button clear-data" aria-label="Clear browsing data">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" />
                    </svg>
                </button>
            </div>
        </header>

        <!-- Main content -->
        <main class="main-content" role="main">
            <!-- Search container -->
            <div class="search-container">
                <div class="search-box">
                    <input type="text" class="search-input" placeholder="Search the web..." aria-label="Search the web">
                    <button class="search-button" aria-label="Search">
                        <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                            <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- PSE containers -->
            <div class="pse-search-container" style="display: none;">
                <!-- Google Programmable Search Engine search box will appear here -->
            </div>
            <div class="pse-results-container" style="display: none;">
                <!-- Google Programmable Search Engine results will appear here -->
            </div>

            <!-- Quick links -->
            <section class="card" aria-labelledby="quick-links-title">
                <div class="card-header">
                    <h2 id="quick-links-title" class="card-title">Quick Links</h2>
                    <button class="card-action add-quick-link" aria-label="Add quick link">Add</button>
                </div>
                <div class="quick-links-grid" id="quick-links-container">
                    <!-- Quick links will be dynamically inserted here -->
                </div>
            </section>

            <!-- Bookmarks -->
            <section class="card" aria-labelledby="bookmarks-title">
                <div class="card-header">
                    <h2 id="bookmarks-title" class="card-title">Bookmarks</h2>
                    <button class="card-action add-bookmark" aria-label="Add bookmark">Add</button>
                </div>
                <div class="bookmarks-list" id="bookmarks-container">
                    <!-- Bookmarks will be dynamically inserted here -->
                </div>
            </section>

            <!-- History -->
            <section class="card" aria-labelledby="history-title">
                <div class="card-header">
                    <h2 id="history-title" class="card-title">Recent Searches</h2>
                    <button class="card-action clear-history" aria-label="Clear history">Clear</button>
                </div>
                <div class="history-list" id="history-container">
                    <!-- History items will be dynamically inserted here -->
                </div>
            </section>
        </main>
    </div>

    <!-- Modals -->
    <div class="modal-overlay add-quick-link-modal" style="display: none;" role="dialog" aria-labelledby="add-quick-link-title">
        <div class="modal">
            <div class="modal-header">
                <h3 id="add-quick-link-title" class="modal-title">Add Quick Link</h3>
                <button class="modal-close" aria-label="Close modal">
                    <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                        <path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" />
                    </svg>
                </button>
            </div>
            <form id="add-quick-link-form">
                <div class="form-group">
                    <label for="quick-link-name" class="form-label">Name</label>
                    <input type="text" id="quick-link-name" class="form-input" required>
                </div>
                <div class="form-group">
                    <label for="quick-link-url" class="form-label">URL</label>
                    <input type="url" id="quick-link-url" class="form-input" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary cancel-quick-link">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add</button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal-overlay add-bookmark-modal" style="display: none;" role="dialog" aria-labelledby="add-bookmark-title">
        <div class="modal">
            <div class="modal-header">
                <h3 id="add-bookmark-title" class="modal-title">Add Bookmark</h3>
                <button class="modal-close" aria-label="Close modal">
                    <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                        <path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" />
                    </svg>
                </button>
            </div>
            <form id="add-bookmark-form">
                <div class="form-group">
                    <label for="bookmark-name" class="form-label">Name</label>
                    <input type="text" id="bookmark-name" class="form-input" required>
                </div>
                <div class="form-group">
                    <label for="bookmark-url" class="form-label">URL</label>
                    <input type="url" id="bookmark-url" class="form-input" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary cancel-bookmark">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        /* THEME MANAGEMENT */
        const ThemeManager = {
            // Initialize theme based on system preference or saved setting
            init: function() {
                const savedTheme = localStorage.getItem('orbito-theme');
                const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                
                if (savedTheme) {
                    document.documentElement.setAttribute('data-theme', savedTheme);
                } else if (systemPrefersDark) {
                    document.documentElement.setAttribute('data-theme', 'dark');
                }
                
                this.updateThemeIcon();
            },
            
            // Toggle between light and dark themes
            toggle: function() {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                
                document.documentElement.setAttribute('data-theme', newTheme);
                localStorage.setItem('orbito-theme', newTheme);
                
                this.updateThemeIcon();
            },
            
            // Update the theme toggle button icon
            updateThemeIcon: function() {
                const themeButton = document.querySelector('.theme-toggle');
                const currentTheme = document.documentElement.getAttribute('data-theme');
                
                if (themeButton) {
                    if (currentTheme === 'dark') {
                        themeButton.innerHTML = `
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,2L14.39,5.42C13.65,5.15 12.84,5 12,5C11.16,5 10.35,5.15 9.61,5.42L12,2M3.34,7L7.5,6.65C6.9,7.16 6.36,7.78 5.94,8.5C5.5,9.24 5.25,10 5.11,10.79L3.34,7M3.36,17L5.12,13.23C5.26,14 5.53,14.78 5.95,15.5C6.37,16.24 6.91,16.86 7.5,17.37L3.36,17M20.65,7L18.88,10.79C18.74,10 18.47,9.23 18.05,8.5C17.63,7.78 17.1,7.15 16.5,6.64L20.65,7M20.64,17L16.5,17.36C17.09,16.85 17.62,16.22 18.04,15.5C18.46,14.77 18.73,14 18.87,13.21L20.64,17M12,22L9.59,18.56C10.33,18.83 11.14,19 12,19C12.82,19 13.63,18.83 14.37,18.56L12,22Z"/>
                            </svg>
                        `;
                    } else {
                        themeButton.innerHTML = `
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12,18C8.69,18 6,15.31 6,12C6,8.69 8.69,6 12,6C15.31,6 18,8.69 18,12C18,15.31 15.31,18 12,18M12,4C7.58,4 4,7.58 4,12C4,16.42 7.58,20 12,20C16.42,20 20,16.42 20,12C20,7.58 16.42,4 12,4M12,7.5C11.17,7.5 10.5,8.17 10.5,9C10.5,9.83 11.17,10.5 12,10.5C12.83,10.5 13.5,9.83 13.5,9C13.5,8.17 12.83,7.5 12,7.5Z"/>
                            </svg>
                        `;
                    }
                }
            }
        };

        /* STORAGE MANAGEMENT */
        const StorageManager = {
            // Check if incognito mode is active
            isIncognito: function() {
                return localStorage.getItem('orbito-incognito') === 'true';
            },
            
            // Toggle incognito mode
            toggleIncognito: function() {
                const current = this.isIncognito();
                localStorage.setItem('orbito-incognito', !current);
                this.updateIncognitoIcon();
                
                // Show notification about incognito mode
                this.showIncognitoNotification(!current);
            },
            
            // Update the incognito button icon
            updateIncognitoIcon: function() {
                const incognitoButton = document.querySelector('.incognito-toggle');
                const isIncognito = this.isIncognito();
                
                if (incognitoButton) {
                    if (isIncognito) {
                        incognitoButton.style.color = 'var(--accent)';
                    } else {
                        incognitoButton.style.color = 'var(--text-secondary)';
                    }
                }
            },
            
            // Show notification about incognito mode status
            showIncognitoNotification: function(isActive) {
                // In a real app, you might show a toast notification here
                console.log(`Incognito mode ${isActive ? 'enabled' : 'disabled'}`);
            },
            
            // Get quick links from storage
            getQuickLinks: function() {
                if (this.isIncognito()) return [];
                
                const links = localStorage.getItem('orbito-quick-links');
                return links ? JSON.parse(links) : this.getDefaultQuickLinks();
            },
            
            // Save quick links to storage
            saveQuickLinks: function(links) {
                if (this.isIncognito()) return;
                localStorage.setItem('orbito-quick-links', JSON.stringify(links));
            },
            
            // Get default quick links
            getDefaultQuickLinks: function() {
                return [
                    { name: 'YouTube', url: 'https://youtube.com', color: '#FF0000' },
                    { name: 'Facebook', url: 'https://facebook.com', color: '#1877F2' },
                    { name: 'Google', url: 'https://google.com', color: '#4285F4' },
                    { name: 'Twitter', url: 'https://twitter.com', color: '#1DA1F2' },
                    { name: 'Wikipedia', url: 'https://wikipedia.org', color: '#000000' },
                    { name: 'Reddit', url: 'https://reddit.com', color: '#FF4500' }
                ];
            },
            
            // Get bookmarks from storage
            getBookmarks: function() {
                if (this.isIncognito()) return [];
                
                const bookmarks = localStorage.getItem('orbito-bookmarks');
                return bookmarks ? JSON.parse(bookmarks) : [];
            },
            
            // Save bookmarks to storage
            saveBookmarks: function(bookmarks) {
                if (this.isIncognito()) return;
                localStorage.setItem('orbito-bookmarks', JSON.stringify(bookmarks));
            },
            
            // Get search history from storage
            getHistory: function() {
                if (this.isIncognito()) return [];
                
                const history = localStorage.getItem('orbito-history');
                return history ? JSON.parse(history) : [];
            },
            
            // Save search history to storage
            saveHistory: function(history) {
                if (this.isIncognito()) return;
                localStorage.setItem('orbito-history', JSON.stringify(history));
            },
            
            // Add a search to history
            addToHistory: function(query) {
                if (this.isIncognito() || !query.trim()) return;
                
                let history = this.getHistory();
                
                // Remove if already exists (to avoid duplicates)
                history = history.filter(item => item.query !== query);
                
                // Add to beginning of array
                history.unshift({
                    query: query,
                    timestamp: new Date().toISOString()
                });
                
                // Keep only last 10 items
                history = history.slice(0, 10);
                
                this.saveHistory(history);
            },
            
            // Clear all browsing data
            clearData: function() {
                if (confirm('Are you sure you want to clear all browsing data? This cannot be undone.')) {
                    localStorage.removeItem('orbito-quick-links');
                    localStorage.removeItem('orbito-bookmarks');
                    localStorage.removeItem('orbito-history');
                    
                    // Reload the page to reflect changes
                    location.reload();
                }
            }
        };

        /* UI MANAGEMENT */
        const UIManager = {
            // Initialize the UI
            init: function() {
                this.renderQuickLinks();
                this.renderBookmarks();
                this.renderHistory();
                this.setupEventListeners();
                this.applyGlowAnimation();
            },
            
            // Render quick links
            renderQuickLinks: function() {
                const container = document.getElementById('quick-links-container');
                const links = StorageManager.getQuickLinks();
                
                if (!container) return;
                
                if (links.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">🔗</div>
                            <div class="empty-state-text">No quick links yet</div>
                        </div>
                    `;
                    return;
                }
                
                container.innerHTML = links.map(link => `
                    <a href="${link.url}" class="quick-link" target="_blank" rel="noopener">
                        <div class="quick-link-icon" style="background-color: ${link.color}">
                            ${link.name.charAt(0)}
                        </div>
                        <div class="quick-link-name">${link.name}</div>
                    </a>
                `).join('');
            },
            
            // Render bookmarks
            renderBookmarks: function() {
                const container = document.getElementById('bookmarks-container');
                const bookmarks = StorageManager.getBookmarks();
                
                if (!container) return;
                
                if (bookmarks.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">🔖</div>
                            <div class="empty-state-text">No bookmarks yet</div>
                        </div>
                    `;
                    return;
                }
                
                container.innerHTML = bookmarks.map(bookmark => `
                    <div class="bookmark-item">
                        <div class="item-icon" style="background-color: ${this.stringToColor(bookmark.name)}">
                            ${bookmark.name.charAt(0)}
                        </div>
                        <div class="item-details">
                            <div class="item-title">${bookmark.name}</div>
                            <div class="item-url">${bookmark.url}</div>
                        </div>
                        <div class="item-actions">
                            <button class="item-action visit-bookmark" data-url="${bookmark.url}" aria-label="Visit bookmark">
                                <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16">
                                    <path d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z" />
                                </svg>
                            </button>
                            <button class="item-action delete-bookmark" data-id="${bookmark.id}" aria-label="Delete bookmark">
                                <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16">
                                    <path d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" />
                                </svg>
                            </button>
                        </div>
                    </div>
                `).join('');
            },
            
            // Render history
            renderHistory: function() {
                const container = document.getElementById('history-container');
                const history = StorageManager.getHistory();
                
                if (!container) return;
                
                if (history.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">🕒</div>
                            <div class="empty-state-text">No recent searches</div>
                        </div>
                    `;
                    return;
                }
                
                container.innerHTML = history.map(item => `
                    <div class="history-item">
                        <div class="item-icon" style="background-color: #5f6368">
                            🔍
                        </div>
                        <div class="item-details">
                            <div class="item-title">${item.query}</div>
                            <div class="item-url">${this.formatDate(item.timestamp)}</div>
                        </div>
                        <div class="item-actions">
                            <button class="item-action search-again" data-query="${item.query}" aria-label="Search again">
                                <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16">
                                    <path d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z" />
                                </svg>
                            </button>
                        </div>
                    </div>
                `).join('');
            },
            
            // Format date for display
            formatDate: function(dateString) {
                const date = new Date(dateString);
                const now = new Date();
                const diffMs = now - date;
                const diffMins = Math.floor(diffMs / 60000);
                const diffHours = Math.floor(diffMs / 3600000);
                const diffDays = Math.floor(diffMs / 86400000);
                
                if (diffMins < 1) return 'Just now';
                if (diffMins < 60) return `${diffMins} min ago`;
                if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;
                if (diffDays < 7) return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`;
                
                return date.toLocaleDateString();
            },
            
            // Generate a color from a string (for icons)
            stringToColor: function(str) {
                let hash = 0;
                for (let i = 0; i < str.length; i++) {
                    hash = str.charCodeAt(i) + ((hash << 5) - hash);
                }
                
                let color = '#';
                for (let i = 0; i < 3; i++) {
                    const value = (hash >> (i * 8)) & 0xFF;
                    color += ('00' + value.toString(16)).substr(-2);
                }
                return color;
            },
            
            // Set up event listeners
            setupEventListeners: function() {
                // Theme toggle
                document.querySelector('.theme-toggle').addEventListener('click', () => {
                    ThemeManager.toggle();
                });
                
                // Incognito toggle
                document.querySelector('.incognito-toggle').addEventListener('click', () => {
                    StorageManager.toggleIncognito();
                    this.renderQuickLinks();
                    this.renderBookmarks();
                    this.renderHistory();
                });
                
                // Clear data
                document.querySelector('.clear-data').addEventListener('click', () => {
                    StorageManager.clearData();
                });
                
                // Search functionality
                const searchInput = document.querySelector('.search-input');
                const searchButton = document.querySelector('.search-button');
                
                const performSearch = () => {
                    const query = searchInput.value.trim();
                    if (!query) return;
                    
                    // Add to history
                    StorageManager.addToHistory(query);
                    this.renderHistory();
                    
                    // Check if PSE is available
                    if (window.google && window.google.search && window.google.search.cse) {
                        // PSE is available, use it
                        document.querySelector('.pse-search-container').style.display = 'block';
                        document.querySelector('.pse-results-container').style.display = 'block';
                        
                        // This would be handled by the PSE script
                        // For demonstration, we'll simulate it
                        console.log('PSE search for:', query);
                    } else {
                        // Fallback: open Google in new tab
                        window.open(`https://www.google.com/search?q=${encodeURIComponent(query)}`, '_blank');
                    }
                };
                
                searchButton.addEventListener('click', performSearch);
                searchInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        performSearch();
                    }
                });
                
                // Add quick link
                document.querySelector('.add-quick-link').addEventListener('click', () => {
                    this.showModal('.add-quick-link-modal');
                });
                
                // Add bookmark
                document.querySelector('.add-bookmark').addEventListener('click', () => {
                    this.showModal('.add-bookmark-modal');
                });
                
                // Clear history
                document.querySelector('.clear-history').addEventListener('click', () => {
                    if (confirm('Are you sure you want to clear your search history?')) {
                        localStorage.removeItem('orbito-history');
                        this.renderHistory();
                    }
                });
                
                // Modal events
                this.setupModalEvents();
                
                // Delegated events for dynamic content
                document.addEventListener('click', (e) => {
                    // Visit bookmark
                    if (e.target.closest('.visit-bookmark')) {
                        const url = e.target.closest('.visit-bookmark').dataset.url;
                        window.open(url, '_blank');
                    }
                    
                    // Delete bookmark
                    if (e.target.closest('.delete-bookmark')) {
                        const id = e.target.closest('.delete-bookmark').dataset.id;
                        this.deleteBookmark(id);
                    }
                    
                    // Search again from history
                    if (e.target.closest('.search-again')) {
                        const query = e.target.closest('.search-again').dataset.query;
                        document.querySelector('.search-input').value = query;
                        document.querySelector('.search-button').click();
                    }
                });
            },
            
            // Set up modal events
            setupModalEvents: function() {
                // Quick link modal
                const quickLinkModal = document.querySelector('.add-quick-link-modal');
                const quickLinkForm = document.getElementById('add-quick-link-form');
                
                document.querySelector('.cancel-quick-link').addEventListener('click', () => {
                    this.hideModal('.add-quick-link-modal');
                });
                
                quickLinkModal.querySelector('.modal-close').addEventListener('click', () => {
                    this.hideModal('.add-quick-link-modal');
                });
                
                quickLinkForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const name = document.getElementById('quick-link-name').value;
                    const url = document.getElementById('quick-link-url').value;
                    
                    this.addQuickLink(name, url);
                    this.hideModal('.add-quick-link-modal');
                    quickLinkForm.reset();
                });
                
                // Bookmark modal
                const bookmarkModal = document.querySelector('.add-bookmark-modal');
                const bookmarkForm = document.getElementById('add-bookmark-form');
                
                document.querySelector('.cancel-bookmark').addEventListener('click', () => {
                    this.hideModal('.add-bookmark-modal');
                });
                
                bookmarkModal.querySelector('.modal-close').addEventListener('click', () => {
                    this.hideModal('.add-bookmark-modal');
                });
                
                bookmarkForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const name = document.getElementById('bookmark-name').value;
                    const url = document.getElementById('bookmark-url').value;
                    
                    this.addBookmark(name, url);
                    this.hideModal('.add-bookmark-modal');
                    bookmarkForm.reset();
                });
                
                // Close modals when clicking outside
                document.querySelectorAll('.modal-overlay').forEach(overlay => {
                    overlay.addEventListener('click', (e) => {
                        if (e.target === overlay) {
                            this.hideModal('.' + overlay.classList[1]);
                        }
                    });
                });
            },
            
            // Show modal
            showModal: function(selector) {
                document.querySelector(selector).style.display = 'flex';
            },
            
            // Hide modal
            hideModal: function(selector) {
                document.querySelector(selector).style.display = 'none';
            },
            
            // Add a quick link
            addQuickLink: function(name, url) {
                if (StorageManager.isIncognito()) return;
                
                // Ensure URL has protocol
                if (!url.startsWith('http://') && !url.startsWith('https://')) {
                    url = 'https://' + url;
                }
                
                const links = StorageManager.getQuickLinks();
                const color = this.stringToColor(name);
                
                links.push({ name, url, color });
                StorageManager.saveQuickLinks(links);
                this.renderQuickLinks();
            },
            
            // Add a bookmark
            addBookmark: function(name, url) {
                if (StorageManager.isIncognito()) return;
                
                // Ensure URL has protocol
                if (!url.startsWith('http://') && !url.startsWith('https://')) {
                    url = 'https://' + url;
                }
                
                const bookmarks = StorageManager.getBookmarks();
                const id = Date.now().toString(); // Simple ID generation
                
                bookmarks.push({ id, name, url });
                StorageManager.saveBookmarks(bookmarks);
                this.renderBookmarks();
            },
            
            // Delete a bookmark
            deleteBookmark: function(id) {
                if (StorageManager.isIncognito()) return;
                
                const bookmarks = StorageManager.getBookmarks();
                const filtered = bookmarks.filter(bookmark => bookmark.id !== id);
                
                StorageManager.saveBookmarks(filtered);
                this.renderBookmarks();
            },
            
            // Apply glow animation on startup
            applyGlowAnimation: function() {
                const searchBox = document.querySelector('.search-box');
                searchBox.classList.add('glow-animation');
                
                setTimeout(() => {
                    searchBox.classList.remove('glow-animation');
                }, 2000);
            }
        };

        /* PSE WIRING */
        // This function will be called when the PSE script loads
        window.__onGCSEApiLoad = function() {
            // PSE script has loaded, initialize it
            console.log('Google Programmable Search Engine loaded');
            
            // The PSE script will automatically render the search box and results
            // into the containers with class 'gcse-search'
        };

        // Check if PSE script is already loaded (in case it's added after this script)
        if (window.google && window.google.search && window.google.search.cse) {
            window.__onGCSEApiLoad();
        }

        /* INITIALIZATION */
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize theme
            ThemeManager.init();
            
            // Initialize incognito mode icon
            StorageManager.updateIncognitoIcon();
            
            // Initialize UI
            UIManager.init();
            
            // PASTE_PSE_SCRIPT_HERE - This is where you would paste the PSE script
            // For demonstration, we'll simulate the PSE script not being present
        });
    </script>
</body>
  </html>
